<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Deep Blue Academy - Test di Idoneit√†</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Fredoka+One&family=Nunito:wght@400;600;700;800&display=swap');

  * { margin: 0; padding: 0; box-sizing: border-box; }

  :root {
    --ocean-dark: #0a1628;
    --ocean-mid: #0d2847;
    --ocean-light: #1a4a7a;
    --teal: #00b4d8;
    --teal-light: #90e0ef;
    --coral: #ff6b6b;
    --coral-light: #ffa8a8;
    --sand: #ffd6a5;
    --white: #ffffff;
    --glass: rgba(255, 255, 255, 0.08);
    --glass-border: rgba(255, 255, 255, 0.15);
  }

  body {
    font-family: 'Nunito', sans-serif;
    background: linear-gradient(180deg, var(--ocean-dark) 0%, var(--ocean-mid) 40%, var(--ocean-light) 100%);
    min-height: 100vh;
    color: var(--white);
    overflow-x: hidden;
    position: relative;
  }

  /* === BUBBLES === */
  .bubbles-container {
    position: fixed; top: 0; left: 0; right: 0; bottom: 0;
    pointer-events: none; z-index: 0; overflow: hidden;
  }
  .bubble {
    position: absolute; bottom: -20px;
    background: radial-gradient(circle at 30% 30%, rgba(255,255,255,0.3), rgba(255,255,255,0.05));
    border-radius: 50%; animation: rise linear infinite;
    border: 1px solid rgba(255,255,255,0.15);
  }
  @keyframes rise {
    0% { transform: translateY(0) scale(1); opacity: 0.6; }
    50% { opacity: 0.3; }
    100% { transform: translateY(-110vh) scale(0.5); opacity: 0; }
  }

  /* === WAVES === */
  .waves {
    position: fixed; bottom: 0; left: 0; right: 0; height: 80px;
    pointer-events: none; z-index: 0;
  }
  .wave {
    position: absolute; bottom: 0; left: -50%; width: 200%; height: 60px;
    background: repeating-linear-gradient(90deg, transparent, transparent 40px,
      rgba(0,180,216,0.05) 40px, rgba(0,180,216,0.05) 80px);
    border-radius: 50% 50% 0 0; animation: wave-move 8s ease-in-out infinite;
  }
  .wave:nth-child(2) { animation-delay: -3s; opacity: 0.5; height: 40px; }
  @keyframes wave-move {
    0%, 100% { transform: translateX(0); }
    50% { transform: translateX(2%); }
  }

  /* === CONTAINER === */
  .container {
    position: relative; z-index: 1; max-width: 500px;
    margin: 0 auto; padding: 20px 16px; min-height: 100vh;
    display: flex; flex-direction: column; align-items: center; justify-content: center;
  }

  /* === CARDS === */
  .card {
    background: var(--glass); backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px);
    border: 1px solid var(--glass-border); border-radius: 24px;
    padding: 32px 24px; width: 100%; text-align: center;
    animation: fadeInUp 0.6s ease-out; box-shadow: 0 8px 32px rgba(0,0,0,0.3);
  }
  @keyframes fadeInUp {
    from { opacity: 0; transform: translateY(30px); }
    to { opacity: 1; transform: translateY(0); }
  }
  .hidden { display: none !important; }

  /* === SPLASH === */
  .splash-icon { font-size: 72px; margin-bottom: 16px; animation: float 3s ease-in-out infinite; }
  @keyframes float {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-10px); }
  }
  .splash-title {
    font-family: 'Fredoka One', cursive; font-size: 28px;
    color: var(--teal-light); margin-bottom: 8px; line-height: 1.2;
  }
  .splash-subtitle {
    font-size: 15px; color: var(--teal-light); opacity: 0.7;
    margin-bottom: 24px; font-style: italic;
  }
  .splash-desc {
    font-size: 16px; line-height: 1.6; margin-bottom: 28px; color: rgba(255,255,255,0.85);
  }
  .splash-warning {
    display: inline-block; background: rgba(255,107,107,0.15);
    border: 1px solid rgba(255,107,107,0.3); border-radius: 12px;
    padding: 10px 16px; font-size: 13px; color: var(--coral-light); margin-bottom: 24px;
  }

  /* === PHOTO CARDS === */
  .photo-frame {
    width: 85%;
    max-width: 300px;
    margin: 16px auto;
    border-radius: 16px;
    overflow: hidden;
    border: 3px solid rgba(255,255,255,0.15);
    box-shadow: 0 4px 20px rgba(0,0,0,0.3);
    position: relative;
  }
  .photo-frame img {
    width: 100%;
    display: block;
    object-fit: cover;
  }
  .photo-caption {
    font-size: 12px;
    color: var(--teal-light);
    opacity: 0.6;
    margin-top: 8px;
    font-style: italic;
  }

  /* === BUTTONS === */
  .btn {
    display: inline-block; padding: 14px 36px; border: none; border-radius: 50px;
    font-family: 'Nunito', sans-serif; font-weight: 800; font-size: 16px;
    cursor: pointer; transition: all 0.3s ease; text-transform: uppercase; letter-spacing: 1px;
  }
  .btn-primary {
    background: linear-gradient(135deg, var(--teal), #0096c7); color: var(--white);
    box-shadow: 0 4px 20px rgba(0,180,216,0.4);
  }
  .btn-primary:hover, .btn-primary:active {
    transform: translateY(-2px); box-shadow: 0 6px 28px rgba(0,180,216,0.5);
  }
  .btn-coral {
    background: linear-gradient(135deg, var(--coral), #ee5a5a); color: var(--white);
    box-shadow: 0 4px 20px rgba(255,107,107,0.4);
  }
  .btn-coral:hover, .btn-coral:active {
    transform: translateY(-2px); box-shadow: 0 6px 28px rgba(255,107,107,0.5);
  }
  .btn-birthday {
    background: linear-gradient(135deg, var(--sand), #ffb347); color: var(--ocean-dark);
    box-shadow: 0 4px 20px rgba(255,214,165,0.4);
  }

  /* === PROGRESS === */
  .progress-section { width: 100%; margin-bottom: 24px; }
  .progress-labels {
    display: flex; justify-content: space-between; font-size: 11px;
    margin-bottom: 6px; color: var(--teal-light); opacity: 0.7;
  }
  .progress-bar {
    width: 100%; height: 8px; background: rgba(255,255,255,0.1);
    border-radius: 4px; overflow: hidden;
  }
  .progress-fill {
    height: 100%; background: linear-gradient(90deg, var(--teal), var(--teal-light));
    border-radius: 4px; transition: width 0.5s ease; width: 0%;
  }
  .progress-level {
    text-align: center; margin-top: 8px; font-size: 13px; font-weight: 700; color: var(--sand);
  }

  /* === QUESTION === */
  .question-number { font-size: 13px; color: var(--teal-light); opacity: 0.6; margin-bottom: 8px; }
  .question-text {
    font-family: 'Fredoka One', cursive; font-size: 20px; line-height: 1.4;
    margin-bottom: 24px; color: var(--white);
  }
  .answers { display: flex; flex-direction: column; gap: 10px; }
  .answer-btn {
    background: rgba(255,255,255,0.06); border: 1px solid rgba(255,255,255,0.12);
    border-radius: 16px; padding: 14px 18px; color: var(--white);
    font-family: 'Nunito', sans-serif; font-size: 15px; font-weight: 600;
    cursor: pointer; transition: all 0.25s ease; text-align: left;
  }
  .answer-btn:hover, .answer-btn:active {
    background: rgba(0,180,216,0.15); border-color: var(--teal); transform: translateX(4px);
  }
  .answer-btn.selected {
    background: rgba(0,180,216,0.25); border-color: var(--teal);
    box-shadow: 0 0 12px rgba(0,180,216,0.2);
  }

  /* === APHORISM === */
  .aphorism-card {
    background: linear-gradient(135deg, rgba(255,214,165,0.1), rgba(255,107,107,0.08));
    border: 1px solid rgba(255,214,165,0.2);
  }
  .aphorism-icon { font-size: 40px; margin-bottom: 12px; }
  .aphorism-text {
    font-style: italic; font-size: 18px; line-height: 1.5;
    color: var(--sand); margin-bottom: 12px;
  }
  .aphorism-author { font-size: 13px; color: var(--coral-light); opacity: 0.7; }

  /* === FEEDBACK === */
  .feedback {
    margin-top: 16px; padding: 14px; border-radius: 14px;
    font-size: 14px; line-height: 1.5; animation: fadeInUp 0.4s ease-out;
  }
  .feedback-funny {
    background: rgba(255,214,165,0.12); border: 1px solid rgba(255,214,165,0.2); color: var(--sand);
  }
  .next-btn-wrap { margin-top: 20px; }

  /* === LOADING === */
  .loading-text {
    font-family: 'Fredoka One', cursive; font-size: 22px;
    color: var(--teal-light); margin-bottom: 20px;
  }
  .loading-bar-container {
    width: 80%; margin: 0 auto 16px; height: 10px;
    background: rgba(255,255,255,0.1); border-radius: 5px; overflow: hidden;
  }
  .loading-bar-fill {
    height: 100%; background: linear-gradient(90deg, var(--teal), var(--coral), var(--sand));
    border-radius: 5px; width: 0%; animation: loading 3s ease-in-out forwards;
  }
  @keyframes loading {
    0% { width: 0%; } 30% { width: 45%; } 60% { width: 70%; }
    85% { width: 88%; } 100% { width: 100%; }
  }
  .loading-details { font-size: 13px; color: rgba(255,255,255,0.5); min-height: 20px; }

  /* === RESULT === */
  .result-score {
    font-family: 'Fredoka One', cursive; font-size: 64px; color: var(--coral); margin: 12px 0;
  }
  .result-label {
    font-size: 14px; color: var(--teal-light); opacity: 0.7; margin-bottom: 4px;
    text-transform: uppercase; letter-spacing: 2px;
  }
  .result-title {
    font-family: 'Fredoka One', cursive; font-size: 22px; color: var(--sand); margin-bottom: 16px;
  }
  .result-text {
    font-size: 15px; line-height: 1.7; color: rgba(255,255,255,0.85); margin-bottom: 24px;
  }
  .result-badge {
    display: inline-block; background: rgba(255,107,107,0.15);
    border: 1px solid rgba(255,107,107,0.3); border-radius: 50px;
    padding: 8px 20px; font-size: 13px; font-weight: 700;
    color: var(--coral-light); margin-bottom: 20px;
  }

  /* === REVEAL (Birthday) === */
  #reveal-screen .card {
    background: linear-gradient(135deg, rgba(255,214,165,0.15), rgba(0,180,216,0.1));
    border-color: rgba(255,214,165,0.3);
  }
  .reveal-icon { font-size: 80px; margin-bottom: 16px; animation: float 2.5s ease-in-out infinite; }
  .reveal-title {
    font-family: 'Fredoka One', cursive; font-size: 26px;
    color: var(--sand); margin-bottom: 16px; line-height: 1.3;
  }
  .reveal-text {
    font-size: 16px; line-height: 1.8; color: rgba(255,255,255,0.9); margin-bottom: 24px;
  }
  .reveal-text strong { color: var(--sand); }
  .reveal-signature {
    font-family: 'Fredoka One', cursive; font-size: 20px; color: var(--teal-light); margin-top: 8px;
  }

  /* === FISH === */
  .fish {
    position: fixed; font-size: 28px; animation: swim linear infinite;
    pointer-events: none; z-index: 0; opacity: 0.4;
  }
  @keyframes swim {
    0% { transform: translateX(-60px) scaleX(1); }
    49% { transform: translateX(calc(100vw + 60px)) scaleX(1); }
    50% { transform: translateX(calc(100vw + 60px)) scaleX(-1); }
    100% { transform: translateX(-60px) scaleX(-1); }
  }

  /* === CONFETTI === */
  .confetti-container {
    position: fixed; top: 0; left: 0; right: 0; bottom: 0;
    pointer-events: none; z-index: 10; overflow: hidden;
  }
  .confetti-piece {
    position: absolute; top: -20px; width: 10px; height: 10px;
    border-radius: 2px; animation: confetti-fall linear forwards;
  }
  @keyframes confetti-fall {
    0% { transform: translateY(0) rotate(0deg); opacity: 1; }
    100% { transform: translateY(110vh) rotate(720deg); opacity: 0; }
  }

  /* Responsive */
  @media (max-width: 380px) {
    .splash-title { font-size: 24px; }
    .question-text { font-size: 18px; }
    .card { padding: 24px 18px; }
  }
</style>
</head>
<body>

<div class="bubbles-container" id="bubbles"></div>
<div class="waves"><div class="wave"></div><div class="wave"></div></div>
<div id="fish-container"></div>

<div class="container">

  <!-- SPLASH -->
  <div id="splash-screen">
    <div class="card">
      <div class="splash-icon">ü§ø</div>
      <div class="splash-title">Deep Blue Academy</div>
      <div class="splash-subtitle">Sede operativa: da qualche parte tra Sansepolcro e Padova</div>

      <!-- FOTO 1: foto di coppia splash -->
      <div class="photo-frame">
        <img id="photo-splash" src="images/foto1.jpg" alt="Marco e Martina">
      </div>
      <div class="photo-caption">Candidata n. 34 ‚Äî fascicolo riservato</div>

      <div class="splash-desc">
        Benvenuta <strong>Martina</strong>!<br><br>
        In occasione del tuo <strong>34esimo compleanno</strong>,
        il tuo compagno di avventure (e di divano) <strong>Marco</strong>
        ha pensato bene di iscriverti al corso
        <strong>"Tuffo Estremo per Principianti Terrorizzati"</strong>.<br><br>
        Prima di procedere, devi superare questo
        questionario di idoneit√† psico-fisica-emotiva.
      </div>
      <div class="splash-warning">
        ‚ö†Ô∏è Il questionario √® obbligatorio, vincolante e totalmente inventato. Forse.
      </div>
      <br>
      <button class="btn btn-primary" onclick="startQuiz()">INIZIA IL TEST üê†</button>
    </div>
  </div>

  <!-- QUESTION -->
  <div id="question-screen" class="hidden">
    <div class="progress-section">
      <div class="progress-labels">
        <span>Inizio</span>
        <span id="progress-percent">0%</span>
      </div>
      <div class="progress-bar">
        <div class="progress-fill" id="progress-fill"></div>
      </div>
      <div class="progress-level" id="progress-level">üêü Livello: Pesce Rosso</div>
    </div>
    <div class="card" id="question-card">
      <div class="question-number" id="q-number"></div>
      <!-- Photo slot inside questions (shown conditionally) -->
      <div class="photo-frame hidden" id="q-photo-frame">
        <img id="q-photo" src="" alt="">
      </div>
      <div class="question-text" id="q-text"></div>
      <div class="answers" id="q-answers"></div>
      <div id="q-feedback" class="hidden"></div>
      <div id="q-next" class="hidden next-btn-wrap">
        <button class="btn btn-primary" onclick="nextStep()">AVANTI ‚Üí</button>
      </div>
    </div>
  </div>

  <!-- APHORISM -->
  <div id="aphorism-screen" class="hidden">
    <div class="card aphorism-card" id="aphorism-card">
      <div class="aphorism-icon" id="aph-icon"></div>
      <!-- Photo slot inside aphorisms (shown conditionally) -->
      <div class="photo-frame hidden" id="aph-photo-frame">
        <img id="aph-photo" src="" alt="">
      </div>
      <div class="aphorism-text" id="aph-text"></div>
      <div class="aphorism-author" id="aph-author"></div>
      <br><br>
      <button class="btn btn-primary" onclick="nextStep()">CONTINUA ‚Üí</button>
    </div>
  </div>

  <!-- LOADING -->
  <div id="loading-screen" class="hidden">
    <div class="card">
      <div class="splash-icon">üî¨</div>
      <div class="loading-text">Analisi in corso...</div>
      <div class="loading-bar-container">
        <div class="loading-bar-fill" id="loading-bar"></div>
      </div>
      <div class="loading-details" id="loading-details"></div>
    </div>
  </div>

  <!-- RESULT -->
  <div id="result-screen" class="hidden">
    <div class="card">
      <div class="splash-icon">üìä</div>
      <div class="result-label">Punteggio di idoneit√†</div>
      <div class="result-score" id="result-score">47%</div>
      <div class="result-badge" id="result-badge">LIVELLO: STELLA MARINA INDECISA</div>

      <!-- FOTO 4: foto divertente nel risultato -->
      <div class="photo-frame">
        <img id="photo-result" src="images/foto4.jpg" alt="Marco e Martina">
      </div>
      <div class="photo-caption">Il volto della candidata durante l'esame (ricostruzione)</div>

      <div class="result-title" id="result-title">Responso ufficiale</div>
      <div class="result-text" id="result-text"></div>
      <button class="btn btn-coral" onclick="showReveal()">MA ASPETTA UN ATTIMO... ü§î</button>
    </div>
  </div>

  <!-- REVEAL (Birthday) -->
  <div id="reveal-screen" class="hidden">
    <div class="card">
      <div class="reveal-icon">üéÇ</div>
      <div class="reveal-title">Ok, il vero motivo di tutto questo...</div>

      <!-- FOTO 5: foto bella per il reveal -->
      <div class="photo-frame">
        <img id="photo-reveal" src="images/foto5.jpg" alt="Marco e Martina">
      </div>

      <div class="reveal-text">
        Non esiste nessuna Deep Blue Academy.<br>
        Non c'√® nessun esame di idoneit√†.<br>
        E no, non ti butto in mare. Per ora.<br><br>
        Questo quiz era solo il modo pi√π assurdo
        che ho trovato per dirti:<br><br>
        <strong style="font-size: 22px;">Buon compleanno, Marti!</strong><br><br>
        34 anni di te, e ancora riesci a rispondere
        a questionari completamente inventati
        con la seriet√† che ti contraddistingue.<br><br>
        Il tuo regalo vero arriva a breve...
        ma intanto preparati, perch√© <strong>un tuffo
        (in qualche forma) potrebbe davvero succedere.</strong>
      </div>
      <div style="font-size: 40px; margin: 12px 0;">üéâüåäüéÇ</div>
      <div class="reveal-signature">Con amore, Marco ‚ù§Ô∏è</div>
    </div>
  </div>

</div>

<div class="confetti-container" id="confetti"></div>

<script>
// ============================================================
// DATA
// ============================================================

const levels = [
  "üêü Livello: Pesce Rosso di Sansepolcro",
  "üê† Livello: Pesce del Tevere",
  "üê° Livello: Pesce Palla Padovano",
  "ü¶à Livello: Squalo Timido",
  "üê¨ Livello: Delfino Ansioso",
  "üßú‚Äç‚ôÄÔ∏è Livello: Sirena del Brenta",
  "ü¶ë Livello: Kraken Domestico",
  "üêô Livello: Polpo Filosofo",
  "üåä Livello: Onda Anomala",
  "üèä‚Äç‚ôÄÔ∏è Livello: Nuotatrice Estrema",
  "üëë Livello: Regina degli Abissi"
];

const questions = [
  {
    question: "Martina, qual √® la prima cosa che fai quando vedi il mare?",
    photo: null,
    answers: [
      "Corro verso le onde urlando",
      "Stendo l'asciugamano e apro Instagram",
      "Controllo se ci sono meduse nel raggio di 3 km",
      "Valuto la temperatura con un piede e poi torno al bar"
    ],
    feedbacks: [
      "Spirito selvaggio! Marco non ci crede neanche un po'.",
      "La Talent Acquisition Specialist anche in vacanza cerca profili... marini.",
      "La prudenza √® la madre della porcellana. O era un altro proverbio?",
      "Il bar: la vera meta di ogni vacanza. Marco approva al 100%."
    ]
  },
  {
    question: "Marco russa. Qual √® la tua strategia di sopravvivenza notturna?",
    photo: null,
    answers: [
      "Tappi per le orecchie, ormai sono professionista",
      "Lo spingo finch√© non si gira. Funziona 1 volta su 47",
      "Dormo prima di lui: la velocit√† √® tutto",
      "Registro i vocali del russamento e glieli mando la mattina come prova"
    ],
    feedbacks: [
      "Professionista certificata. Anni di esperienza nel campo.",
      "1 su 47: una statistica migliore di molti fondi d'investimento.",
      "Strategia da Project Manager: anticipare i problemi. Marco ti ha insegnato bene.",
      "Prove audio in tribunale: un classico delle coppie longeve."
    ]
  },
  {
    question: "Quanto √® profonda una piscina olimpionica?",
    photo: null,
    answers: [
      "2 metri",
      "3 metri",
      "Non mi importa, ci entro solo se c'√® l'idromassaggio",
      "Abbastanza da perderci le infradito"
    ],
    feedbacks: [
      "Corretto! Ma ammettilo, hai googlato.",
      "N√¨. Ma apprezziamo la sicurezza con cui hai sbagliato.",
      "Priorit√† chiare. Una donna che sa cosa vuole.",
      "Le infradito perse: il vero dramma estivo dal 1992."
    ]
  },
  {
    question: "Scegli il tuo animale marino spirituale:",
    photo: "images/foto2.jpg",
    answers: [
      "ü¶Ä Granchio: cammino lateralmente ma arrivo sempre",
      "üê¢ Tartaruga: lenta ma determinata, e vivo 150 anni",
      "ü¶ë Calamaro: elegante, misterioso, buono fritto",
      "üêö Conchiglia: tecnicamente non un animale ma ci sto bene"
    ],
    feedbacks: [
      "Il granchio √® il filosofo del mare. Andare lateralmente nella vita √® sottovalutato.",
      "La tartaruga vince ogni maratona... se ha abbastanza tempo. Tipo 3 settimane.",
      "Elegante E buono fritto? Un curriculum perfetto. Lo inserisci su LinkedIn?",
      "La conchiglia √® uno stato d'animo. Accettato."
    ]
  },
  {
    question: "In un colloquio, il candidato ti dice: 'Come hobby faccio il sub.' Tu pensi:",
    photo: null,
    answers: [
      "Interessante, denota spirito avventuroso!",
      "Bene, almeno sa trattenere il respiro sotto pressione",
      "Mi chiedo quanto guadagna per permetterselo",
      "Spero che non mi inviti a provare"
    ],
    feedbacks: [
      "La Talent Acquisition Specialist parla! Risposta da manuale HR.",
      "Trattenere il respiro sotto pressione: soft skill richiesta in ogni job posting.",
      "Il vero screening: stipendio attuale + hobby costosi = aspettativa salariale.",
      "Plot twist: qualcuno ti ci porter√† comunque. Spoiler: si chiama Marco."
    ]
  },
  {
    question: "Domanda tecnica: cos'√® la 'decompressione'?",
    photo: null,
    answers: [
      "Quando torni in superficie e i gas nel sangue fanno cose strane",
      "Quella cosa che fai dopo una giornata di lavoro in Zucchetti",
      "Un tipo di caff√® molto rilassante",
      "Non lo so ma suona pericoloso, posso uscire?"
    ],
    feedbacks: [
      "Corretta! Iniziamo a preoccuparci che tu sia troppo preparata.",
      "La decompressione post-Zucchetti: divano, copertina, e Marco che cucina. O ordina.",
      "Il Decaffeinato Decompresso‚Ñ¢ ‚Äî lo brevetti e diventi ricca.",
      "La porta √® da quella parte. Ma dietro c'√® Marco con la muta da sub."
    ]
  },
  {
    question: "Completa la frase: 'Sansepolcro √® famosa per...'",
    photo: null,
    answers: [
      "Piero della Francesca, ovviamente",
      "La gente che se ne va a Padova",
      "I suoi subacquei di fama mondiale (fonte: nessuna)",
      "Le colline, il cibo, e Marco che dice 'ai miei tempi...'"
    ],
    feedbacks: [
      "Risposta da manuale! Piero approverebbe (probabilmente no, era burbero).",
      "Da Sansepolcro a Padova: la migrazione pi√π romantica della Toscana.",
      "La squadra sub di Sansepolcro: 0 membri, 0 vittorie, grande potenziale.",
      "'Ai miei tempi' √® il preambolo ufficiale di ogni storia di Marco."
    ]
  },
  {
    question: "Il tuo istruttore ti dice: 'oggi ci tuffiamo a 30 metri.' Tu rispondi:",
    photo: "images/foto3.jpg",
    answers: [
      "Perfetto, finalmente un po' di adrenalina!",
      "Ok, ma prima devo mandare un vocale di 7 minuti a Marco",
      "30 metri?! Io mi fermo al primo e aspetto l√¨ col telefono",
      "Faccio finta di svenire per evitare il tuffo"
    ],
    feedbacks: [
      "Temeraria! A 30 metri l'adrenalina non mancher√†, promesso.",
      "Il vocale pre-immersione: 'MARCOOOO HO PAURAAAA' ‚Äî 7 minuti, zero info utili.",
      "Un metro, col telefono impermeabile. La vera avventura moderna.",
      "Tecnica dello svenimento tattico: usata dal 73% degli studenti. Dato inventato."
    ]
  },
  {
    question: "Cosa porteresti in una grotta sottomarina?",
    photo: null,
    answers: [
      "Una torcia, ovviamente",
      "Uno snack, perch√© dopo le 17 il metabolismo chiama",
      "Marco, come scudo umano",
      "Niente. Perch√© NON ci entro. Mai. Fine."
    ],
    feedbacks: [
      "Risposta sensata. Ci stai togliendo il divertimento.",
      "Il metabolismo delle 17: il vero boss finale di ogni giornata.",
      "Marco come scudo umano: usato anche contro ragni, rumori notturni e vicini.",
      "La risposta pi√π intelligente e pi√π onesta di tutto il questionario."
    ]
  },
  {
    question: "Domanda definitiva: secondo te, perch√© Marco ti ha mandato questo quiz?",
    photo: null,
    answers: [
      "Perch√© √® fatto cos√¨: complicato anche per farti gli auguri",
      "Per terrorizzarmi. Missione compiuta.",
      "Perch√© 'auguri amore' su WhatsApp era troppo facile per un PM",
      "Non lo so, ma sicuramente c'√® sotto qualcosa..."
    ],
    feedbacks: [
      "Un Project Manager IT che fa le cose semplici? Mai. Troppo banale.",
      "Terrorizzare con amore: la specialit√† della casa.",
      "'Troppo facile' non √® nel vocabolario di chi gestisce sprint e backlog.",
      "C'√® sempre sotto qualcosa. Ma stavolta √® solo tanto affetto. E forse un tuffo."
    ]
  }
];

const aphorisms = [
  {
    text: "\"Chi non si tuffa, non trova perle. Chi si tuffa, trova meduse. La vita √® una medusa.\"",
    author: "‚Äî Capitano Ignazio Salmone, 1847 (mai esistito)",
    icon: "ü¶™",
    photo: null
  },
  {
    text: "\"Il mare insegna agli uomini a nuotare. Il divano insegna a non dover nuotare. Padova insegna a prendere lo spritz.\"",
    author: "‚Äî Proverbio anonimo delle Osterie Venete",
    icon: "üçπ",
    photo: null
  },
  {
    text: "\"Non contare i candidati prima di averli assunti, n√© i pesci prima di averli persi.\"",
    author: "‚Äî Confucio HR (versione Talent Acquisition)",
    icon: "üêü",
    photo: null
  },
  {
    text: "\"Un Project Manager saggio non discute col polpo. Il polpo ha otto tentacoli e zero deadline.\"",
    author: "‚Äî Antico detto della Scuola Agile dei Molluschi",
    icon: "üêô",
    photo: null
  },
  {
    text: "\"L'acqua √® paziente: aspetta sempre che tu ci cada dentro. Come le scadenze di progetto.\"",
    author: "‚Äî Maestro Zen delle Pozzanghere, III secolo",
    icon: "üßò",
    photo: null
  },
  {
    text: "\"Se Sansepolcro avesse il mare, non sareste mai andati a Padova. Ma il Tevere ce la mette tutta.\"",
    author: "‚Äî Anonimo toscano emigrato in Veneto, 2019",
    icon: "üèîÔ∏è",
    photo: null
  }
];

// ============================================================
// GAME STATE
// ============================================================
let currentStep = 0;
let totalSteps = [];
let score = 0;

function buildSequence() {
  totalSteps = [];
  let aphIdx = 0;
  for (let i = 0; i < questions.length; i++) {
    totalSteps.push({ type: 'question', index: i });
    if ((i === 2 || i === 5 || i === 7) && aphIdx < aphorisms.length) {
      totalSteps.push({ type: 'aphorism', index: aphIdx });
      aphIdx++;
    }
  }
  totalSteps.push({ type: 'loading' });
  totalSteps.push({ type: 'result' });
}

// ============================================================
// NAVIGATION
// ============================================================

function hideAllScreens() {
  document.querySelectorAll('#splash-screen, #question-screen, #aphorism-screen, #loading-screen, #result-screen, #reveal-screen')
    .forEach(el => el.classList.add('hidden'));
}

function showScreen(id) {
  hideAllScreens();
  document.getElementById(id).classList.remove('hidden');
  window.scrollTo({ top: 0, behavior: 'smooth' });
}

function startQuiz() {
  buildSequence();
  currentStep = 0;
  score = 0;
  showStep();
}

function showStep() {
  if (currentStep >= totalSteps.length) return;
  const step = totalSteps[currentStep];
  if (step.type === 'question') showQuestion(step.index);
  else if (step.type === 'aphorism') showAphorism(step.index);
  else if (step.type === 'loading') showLoading();
  else if (step.type === 'result') showResult();
}

function nextStep() {
  currentStep++;
  showStep();
}

// ============================================================
// QUESTIONS
// ============================================================

function showQuestion(qIdx) {
  showScreen('question-screen');
  const q = questions[qIdx];
  const qNum = qIdx + 1;
  const total = questions.length;

  const pct = Math.round((qIdx / total) * 100);
  document.getElementById('progress-fill').style.width = pct + '%';
  document.getElementById('progress-percent').textContent = pct + '%';
  const levelIdx = Math.min(Math.floor(qIdx / (total / levels.length)), levels.length - 1);
  document.getElementById('progress-level').textContent = levels[levelIdx];

  document.getElementById('q-number').textContent = `Domanda ${qNum} di ${total}`;
  document.getElementById('q-text').textContent = q.question;

  // Photo inside question
  const photoFrame = document.getElementById('q-photo-frame');
  const photoImg = document.getElementById('q-photo');
  if (q.photo) {
    photoImg.src = q.photo;
    photoFrame.classList.remove('hidden');
  } else {
    photoFrame.classList.add('hidden');
  }

  const answersDiv = document.getElementById('q-answers');
  answersDiv.innerHTML = '';
  q.answers.forEach((ans, i) => {
    const btn = document.createElement('button');
    btn.className = 'answer-btn';
    btn.textContent = ans;
    btn.onclick = () => selectAnswer(qIdx, i);
    answersDiv.appendChild(btn);
  });

  document.getElementById('q-feedback').classList.add('hidden');
  document.getElementById('q-next').classList.add('hidden');

  const card = document.getElementById('question-card');
  card.style.animation = 'none';
  card.offsetHeight;
  card.style.animation = 'fadeInUp 0.5s ease-out';
}

function selectAnswer(qIdx, ansIdx) {
  const q = questions[qIdx];
  const btns = document.querySelectorAll('#q-answers .answer-btn');
  btns.forEach((b, i) => {
    b.classList.toggle('selected', i === ansIdx);
    b.style.pointerEvents = 'none';
  });
  score += Math.floor(Math.random() * 15) + 3;
  const fb = document.getElementById('q-feedback');
  fb.className = 'feedback feedback-funny';
  fb.innerHTML = 'üòÇ ' + q.feedbacks[ansIdx];
  fb.classList.remove('hidden');
  document.getElementById('q-next').classList.remove('hidden');
  setTimeout(() => fb.scrollIntoView({ behavior: 'smooth', block: 'nearest' }), 100);
}

// ============================================================
// APHORISMS
// ============================================================

function showAphorism(aphIdx) {
  showScreen('aphorism-screen');
  const aph = aphorisms[aphIdx];
  document.getElementById('aph-icon').textContent = aph.icon;
  document.getElementById('aph-text').textContent = aph.text;
  document.getElementById('aph-author').textContent = aph.author;

  // Photo inside aphorism
  const photoFrame = document.getElementById('aph-photo-frame');
  const photoImg = document.getElementById('aph-photo');
  if (aph.photo) {
    photoImg.src = aph.photo;
    photoFrame.classList.remove('hidden');
  } else {
    photoFrame.classList.add('hidden');
  }

  const card = document.getElementById('aphorism-card');
  card.style.animation = 'none';
  card.offsetHeight;
  card.style.animation = 'fadeInUp 0.6s ease-out';
}

// ============================================================
// LOADING
// ============================================================

function showLoading() {
  showScreen('loading-screen');
  const bar = document.getElementById('loading-bar');
  bar.style.animation = 'none';
  bar.offsetHeight;
  bar.style.animation = 'loading 3.5s ease-in-out forwards';

  const details = document.getElementById('loading-details');
  const messages = [
    "Analisi livello di coraggio...",
    "Calcolo resistenza al panico...",
    "Verifica compatibilit√† con i pesci...",
    "Consultazione col Tevere di Sansepolcro...",
    "Interrogazione dei canali di Padova...",
    "Confronto con il CV LinkedIn di Martina...",
    "Conteggio anni di sopravvivenza con Marco...",
    "Risultato quasi pronto..."
  ];

  let msgIdx = 0;
  details.textContent = messages[0];
  const interval = setInterval(() => {
    msgIdx++;
    if (msgIdx < messages.length) {
      details.textContent = messages[msgIdx];
    } else {
      clearInterval(interval);
      setTimeout(() => nextStep(), 800);
    }
  }, 500);
}

// ============================================================
// RESULT
// ============================================================

function showResult() {
  showScreen('result-screen');
  const displayScore = Math.min(score, 47);
  document.getElementById('result-score').textContent = displayScore + '%';

  document.getElementById('result-text').innerHTML = `
    Cara Martina,<br><br>
    dopo un'attenta analisi delle tue risposte,
    una consultazione con tre delfini certificati
    e un rapido check col Tevere,
    il nostro verdetto √® chiaro:<br><br>
    <strong>Ti consigliamo di restare in superficie,
    preferibilmente con uno spritz in mano
    in qualche osteria padovana.</strong><br><br>
    Per√≤... Marco ha ancora qualcosa da dirti. üëá
  `;

  const scoreEl = document.getElementById('result-score');
  let count = 0;
  const target = displayScore;
  const interval = setInterval(() => {
    count += 1;
    scoreEl.textContent = count + '%';
    if (count >= target) clearInterval(interval);
  }, 40);
}

// ============================================================
// REVEAL (Birthday)
// ============================================================

function showReveal() {
  showScreen('reveal-screen');
  launchConfetti();
}

// ============================================================
// CONFETTI
// ============================================================

function launchConfetti() {
  const container = document.getElementById('confetti');
  container.innerHTML = '';
  const colors = ['#ff6b6b', '#ffd6a5', '#00b4d8', '#90e0ef', '#ffffff', '#ff85a1', '#ffc300'];
  for (let i = 0; i < 80; i++) {
    const piece = document.createElement('div');
    piece.className = 'confetti-piece';
    piece.style.left = Math.random() * 100 + '%';
    piece.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
    piece.style.width = (Math.random() * 8 + 5) + 'px';
    piece.style.height = (Math.random() * 8 + 5) + 'px';
    piece.style.animationDuration = (Math.random() * 2 + 2) + 's';
    piece.style.animationDelay = (Math.random() * 1.5) + 's';
    container.appendChild(piece);
  }
  setTimeout(() => {
    for (let i = 0; i < 50; i++) {
      const piece = document.createElement('div');
      piece.className = 'confetti-piece';
      piece.style.left = Math.random() * 100 + '%';
      piece.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
      piece.style.width = (Math.random() * 8 + 5) + 'px';
      piece.style.height = (Math.random() * 8 + 5) + 'px';
      piece.style.animationDuration = (Math.random() * 2 + 2) + 's';
      piece.style.animationDelay = (Math.random() * 1) + 's';
      container.appendChild(piece);
    }
  }, 1500);
}

// ============================================================
// DECORATIONS
// ============================================================

function createBubbles() {
  const container = document.getElementById('bubbles');
  for (let i = 0; i < 20; i++) {
    const bubble = document.createElement('div');
    bubble.className = 'bubble';
    const size = Math.random() * 20 + 8;
    bubble.style.width = size + 'px';
    bubble.style.height = size + 'px';
    bubble.style.left = Math.random() * 100 + '%';
    bubble.style.animationDuration = (Math.random() * 8 + 6) + 's';
    bubble.style.animationDelay = (Math.random() * 10) + 's';
    container.appendChild(bubble);
  }
}

function createFish() {
  const container = document.getElementById('fish-container');
  const fishEmojis = ['üêü', 'üê†', 'üê°', 'ü¶ê', 'ü¶Ä'];
  for (let i = 0; i < 4; i++) {
    const fish = document.createElement('div');
    fish.className = 'fish';
    fish.textContent = fishEmojis[Math.floor(Math.random() * fishEmojis.length)];
    fish.style.top = (Math.random() * 80 + 10) + '%';
    fish.style.animationDuration = (Math.random() * 15 + 12) + 's';
    fish.style.animationDelay = (Math.random() * 8) + 's';
    fish.style.fontSize = (Math.random() * 16 + 18) + 'px';
    container.appendChild(fish);
  }
}

createBubbles();
createFish();
</script>
</body>
</html>
